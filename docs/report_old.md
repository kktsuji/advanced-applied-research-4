\begin{center}
{\LARGE \textbf{特別応用研究Ⅳ - 空間周波数特性を考慮したデジタル画像フィルタ設計}}
\end{center}

\begin{flushright}
UNIVERSITY 工学専攻 COURSEコース LAB研究室\\
博士後期課程Y年 STUDENTNUMBER\\
NAME
\end{flushright}

## 1. はじめに

本レポートでは、デジタル画像のフィルタリング処理を空間周波数特性の観点から考察する。

## 2. デジタル画像における空間周波数

デジタル画像とは、離散化した数値データの集合として画像を表現したものである。デジタル画像は通常2次元の配列として表現され、配列の各要素はイメージセンサ上の画素に対応する。一般的に使用される画像では、1画素は 8 [bit] の情報量を持ち、256段階の輝度値を表現できる。輝度値が 0 の場合は黒、255 の場合は白を表す。カラー画像の場合は、1画素は RGB (赤、緑、青) の 3チャネルを持ち、その各チャネルの輝度値の組み合わせで色を表現する。本レポートでは、議論の簡略化のため、1画素当たり 1チャネルを持つグレースケール画像を考える。

ここで、デジタル画像における空間周波数を考える。一般に、デジタル画像の空間周波数は画像上の輝度値の変化の周期性を表すものであり、輝度値が急激に変化する部分 (エッジ) は高い空間周波数を持ち、緩やかに変化する部分 (平坦な領域) は低い空間周波数を持つ。デジタル画像上で最も高い空間周波数を持つのは、隣り合う 1画素ごとに輝度値が 0 と 255 との2値で周期的に変化する場合である。この場合の正弦波の周期は 2 [pixel]であり、空間周波数は 1/2 [cycle/pixel] となる (図1a)。一方、空間周波数が低くなると、正弦波の周期が大きくなることを意味し、画像としては 0 と 255 がなだらかに変化するグラデーションを示す (図1b)。空間周波数が最も低い場合は、画像全体が単一の輝度値を持つ状態である (図1c)。

図1: 正弦波とそれに対応する画像

実際のデジタル画像の例を図2に示す。(a) に示すような輝度変化の激しいテクスチャ領域は空間周波数が高く、(b) に示すような輝度変化がなだらかな領域は空間周波数が低いことが分かる。

図2: 適当な自然画像。草と空などが含まれているものを探して記載する

## 3. デジタル画像のノイズの種類

- イメージセンサで撮像した際にノイズが発生する。主なノイズの種類を図3に示す。
- 多くの場合、光ショットノイズが支配的となる。これはランダムノイズとも呼ばれる。
- 暗い場所では暗電流などが支配的となる。
- ノイズに関しても空間周波数特性を考えることができる。基本的にデジタル画像では光ショットノイズが支配的となり、これは画素ごとにランダムに発生するノイズであるため、空間周波数は高い。
- 一方、画素の欠陥や、レンズやイメージセンサ上に異物が付着している場合など、複数ピクセルに渡りシミのような見た目のノイズが発生することがある。これは、光ショットノイズに比べて空間周波数が低いノイズ成分である。
- また、被写体に対し光源が斜めに光を照射している場合や、レンズシュエーディングによる画像周辺部の光量減少など、画像全体に渡り緩やかに変化するノイズ成分は、空間周波数が更に低いノイズである。
- このように、デジタル画像におけるノイズは、空間周波数の観点から見ると、非常に高い空間周波数を持つ成分から、非常に低い空間周波数を持つ成分まで様々な種類が存在する。画像処理においては、ノイズ成分に対しフィルタリング処理を行うことでノイズ除去を行うが、低減したいノイズの空間周波数に応じたフィルタを設計することが重要である。

図3: 周波数ごとのノイズの模式図

## 4. 代表的なフィルタリング処理

デジタル画像のフィルタリング処理は、ある入力画像 $I$ と、ある $Y \times X$ 行列のフィルタ $F$ の畳み込み演算として計算される。

$$
O(y, x) = \frac{1}{\sum F} \sum_{dy = 0}^Y \sum_{dx = 0}^X I \left (y + dy - \left \lfloor \frac{Y}{2} \right \rfloor , x + dx - \left \lfloor \frac{X}{2} \right \rfloor \right) F(dy, dx)
$$

ここで、$O$ はフィルタリング結果画像、$(y, x)$ は注目画素の座標、$(dy, dx)$ は参照画素の座標、床関数 $\lfloor K \rfloor$ は、ある実数 $K$ を超えない整数を意味する。また、$\frac{1}{\sum F}$ はフィルタ係数の合計による正規化処理を意味し、フィルタリング処理前後で画素値の輝度レベルを等しく保つ意味を持つ。

以下に、代表的なフィルタリング処理をいくつか示す。

### 4.1 ボックスフィルタ

ボックスフィルタはボックス線形フィルタとも呼ばれ、ある画素とその周囲の画素の輝度値の平均を計算するフィルタである。

$$ F\_{box}(y, x) = \frac{1}{Y \times X} $$

例えば、$Y = 3, X = 3$ の場合、ボックスフィルタは以下の行列で表される。

$$
F_{box} = \frac{1}{9} \begin{bmatrix}
1 & 1 & 1 \\
1 & 1 & 1 \\
1 & 1 & 1 \\
\end{bmatrix}
$$

$N, M$ が2のべき乗であるとき、ボックスフィルタ処理はビットシフト演算で実装できるため、処理の高速化が可能である。例えば、例えば、$Y = 2, X = 2$ の場合、合計後の画素値を4で除算するが、これは 2回右へビットシフトすることで表現できる。

### 4.2 ガウシアンフィルタ

ガウシアンフィルタは、ガウス分布に基づくフィルタであり、ボックスフィルタよりもエッジを保持しながらノイズを除去することができる。ガウシアンフィルタは以下で定義される。

$$
F_{gaussian}(y, x) = \frac{1}{2 \pi \sigma^2} e^{-\frac{y^2 + x^2}{2 \sigma^2}}
$$

ここで、$\sigma$ はガウス分布の標準偏差であり、フィルタの広がりを決定するパラメータである。$\sigma$ が大きいほどフィルタは広がり、より多くの周囲画素を考慮することを意味する。つまり、$\sigma$ が大きいほど平滑化効果が強くなり、同時にエッジをぼかす効果が強くなる。

## フィルタのサイズと空間周波数

## 書くこと

- よく使われるフィルタとその空間周波数
  - ボックス、イプシロン、ガウシアン
- 低周波数ノイズに対するフィルタリング
  - 広いカーネル
  - 画像を縮小
- (want) AI学習における画像縮小の意味
